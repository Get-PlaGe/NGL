@()
<div class="row-fluid">
	<div class="page-header" ng-init="init()">
	 <h1 ng-switch on="run.valuation.valid">
	
	 	<span ng-switch-when="FALSE" class="text-error">{{run.code}}</span> 
	 	<span ng-switch-when="TRUE" class="text-success">{{run.code}}</span> 
	 	<span ng-switch-default class="mute">{{run.code}}</span> 
	
		<small>   
			<span ng-model="run.state.code" codes="state"/>
		</small>
		<div class="btn-toolbar pull-right" ng-show="isEditMode()">
		 <button class="btn" ng-click="save()" data-toggle="tooltip" title="@Messages("button.validate")" ><i class="icon-save icon-large"></i> @Messages("button.validate")</button>
		 <button class="btn" ng-click="cancel()" data-toggle="tooltip" title="@Messages("button.cancel")" ><i class="icon-undo icon-large"></i> @Messages("button.cancel")</button>		 
		</div>
		<div class="btn-toolbar pull-right" ng-hide="isEditMode()">
		<button class="btn" ng-click="activeEditMode()" data-toggle="tooltip" title="@Messages("button.edit")" ><i class="icon-edit icon-large"></i> @Messages("button.edit")</button>
		</div>
	 </h1>
	</div>
</div>

<div class="row-fluid" messages="messages"></div>

<div class="row-fluid">
	<form class="form-horizontal">
		<div class="span3">
			<dl class="dl-horizontal">
				<dt>@Messages("runs.code")</dt>
				<dd >{{run.code}}</dd>				
			</dl>
			<dl class="dl-horizontal">
				<dt>@Messages("runs.state.code")</dt>
				<dd ng-model='run.state.code' codes="state"></dd>
			</dl>
			<dl class="dl-horizontal">
				<dt>@Messages("runs.valuation.valid")</dt>
				<dd>
					<div ng-switch on="isEditMode()">
						<div ng-switch-when="false" ng-model='run.valuation.valid' codes="valuation"/>
						<div ng-switch-when="true">
							<div bt-select class="span12" ng-model="run.valuation.valid" bt-options="valid.code as valid.name for valid in lists.getValuations()"></div>
						</div>
					</div>
				</dd>
			</dl>
			<dl class="dl-horizontal">
				<dt>@Messages("runs.valuation.resolutions")</dt>
				<dd>
					<div bt-select class="span12" ng-model="run.valuation.resolutionCodes" multiple="true" bt-options="valid.code as valid.name group by valid.category.name for valid in lists.getResolutions()" ng-edit="isEditMode()"></div>
				</dd>
			</dl>
			<dl class="dl-horizontal">
				<dt>@Messages("runs.valuation.criteria")</dt>
				<dd>
					<div ng-switch on="isEditMode()">
						<div ng-switch-when="false" ng-model="run.valuation.criteriaCode" codes="valuation_criteria"/>
						<div ng-switch-when="true">
							<div bt-select class="span12" ng-model="run.valuation.criteriaCode" bt-options="valid.code as valid.name for valid in lists.getValuationCriterias()"></div>
						</div>
					</div>
				</dd>
			</dl>
			<dl class="dl-horizontal">
				<dt>@Messages("runs.valuation.user")</dt>
				<dd>{{run.valuation.user}} ({{run.valuation.date | date:'@Messages("date.format")'}})</dd>				
			</dl>
		</div>
		<div class="span3">
			<dl class="dl-horizontal">
				<dt>@Messages("runs.type")</dt>
				<dd>{{run.typeCode}}</dd>
			</dl>
			<dl class="dl-horizontal">
				<dt>@Messages("runs.nbClusterTotal")</dt>
				<dd>{{run.treatments.ngsrg["default"].nbClusterTotal.value | number}}</dd>
			</dl>
			<dl class="dl-horizontal">
				<dt>@Messages("runs.percentClusterIlluminaFilter")</dt>
				<dd>{{run.treatments.ngsrg["default"].percentClusterIlluminaFilter.value	| number}}</dd>
			</dl>
			<dl class="dl-horizontal">
				<dt>@Messages("runs.nbClusterIlluminaFilter")</dt>
				<dd>{{run.treatments.ngsrg["default"].nbClusterIlluminaFilter.value	| number}}</dd>
			</dl>
			<dl class="dl-horizontal">
				<dt>@Messages("runs.nbBase")</dt>
				<dd>{{run.treatments.ngsrg["default"].nbBase.value | number}}</dd>
			</dl>
			<dl class="dl-horizontal">
				<dt>@Messages("runs.keep")</dt>
				<dd>
					 <label class="checkbox">
						<input type="checkbox"  ng-model="run.keep" ng-if="isEditMode()">
						<div ng-switch on="run.keep" ng-if="!isEditMode()">
							<i ng-switch-when="true" class="icon-check icon-large"></i>
							<i ng-switch-default class="icon-check-empty icon-large"></i>
						</div>					
					</label>										
				</dd>
			</dl>
		</div>
		<div class="span3">
			<dl class="dl-horizontal">
				<dt>@Messages("runs.nbCycle")</dt>
				<dd>{{run.treatments.ngsrg["default"].nbCycle.value}}</dd>
			</dl>
			<dl class="dl-horizontal">
				<dt>@Messages("runs.controlLane")</dt>
				<dd>{{run.treatments.ngsrg["default"].controlLane.value}}</dd>
			</dl>
			<dl class="dl-horizontal">
				<dt>@Messages("runs.containerSupportCode")</dt>
				<dd>{{run.containerSupportCode}}</dd>
			</dl>
			<dl class="dl-horizontal">
				<dt>@Messages("runs.flowcellPosition")</dt>
				<dd>{{run.treatments.ngsrg["default"].flowcellPosition.value}}</dd>
			</dl>
		</div>
		<div class="span3">
			<dl class="dl-horizontal">
				<dt>@Messages("runs.rtaVersion")</dt>
				<dd>{{run.treatments.ngsrg["default"].rtaVersion.value}}</dd>
			</dl>
			<dl class="dl-horizontal">
				<dt>@Messages("runs.flowcellVersion")</dt>
				<dd>{{run.treatments.ngsrg["default"].flowcellVersion.value}}</dd>
			</dl>
			<dl class="dl-horizontal">
				<dt>@Messages("runs.intrumentCode")</dt>
				<dd>{{run.instrumentUsed.code}}</dd>
			</dl>
			<dl class="dl-horizontal">
				<dt>@Messages("runs.intrumentTypeCode")</dt>
				<dd>{{run.instrumentUsed.typeCode}}</dd>
			</dl>
		</div>
	</form>		
</div>

<div ng-switch on="isEditMode()">
	<div ng-switch-when="true">
		<dl class="dl-horizontal">
			<dt>@Messages("runs.valuation.comment")</dt>
			<dd><textarea ng-model="run.valuation.comment"></textarea></dd>				
		</dl>
	</div>
</div>
<div class="row-fluid">
	<div class="span9">
		@views.html.commons.treatments()
	</div>
	<div class="span3">
		<ul class="nav nav-tabs">
			   <li class="active"><a href="#" >@Messages("runs.lane.valuation.title")</a></li>		   
		</ul>
		<div class="tab-content">
			<div class="tab-pane active">		
	  			<div datatable="lanesDT"></div>
			</div>
		</div>
	</div>
</div>

<div class="row-fluid">
	<ul class="nav nav-tabs">
		<li class="active"><a>@Messages("runs.readsets.title") ({{readSetsDT.totalNumberRecords}})</a></li>		   
	</ul>
	<div class="tab-content">
		<div class="tab-pane active"></div>	
		<div class="row-fluid">
			<div class="span5">				
	 			<form class="well well-small form-inline">
					<div bt-select  ng-model="form.laneNumbers" multiple="true" placeholder="@Messages("search.placeholder.lanes")" bt-options="l.number as l.number for l in laneOptions"></div>				
					<div class="btn-group pull-right">
					<button type="submit" title='@Messages("button.search")' data-toggle="tooltip" ng-click="search()" class="btn btn-primary" ><i class="icon-search icon-large"></i></button>
					<button type="submit" ng-click="showReadSets()" class="btn" >@Messages("button.readsets.show")</button>
					<button type="submit" ng-click="valuateReadSets()" class="btn" ng-if="isEditMode()">@Messages("button.readsets.valuation")</button>
					</div>										 						
	 			</form>	
			</div> 
		</div>
		<div datatable="readSetsDT"></div>
	</div>
</div>

       
