@*
*	Create a datatable
*	config: views.components.datatable.DatatableConfig : datatable configuration
*	form: Html : search form
*	buttons: Html : additionnal buttons
*	
*@
@(config: views.components.datatable.DatatableConfig, form: Html = Html(""), buttons: Html = Html(""))
@import views.components.datatable.DatatableColumn
<div class="datatable" ng-init="@(config.name).setColumnsConfig(@config.toJson())">
<div class="row-fluid">
@form
</div>

<div class="row-fluid" ng-show="@(config.name).isShowToolbar()">
<div class="span6">
@if(config.button){
<div class="btn-toolbar pull-left" ng-show="@(config.name).isShowToolbarLeft()">
	<div class="btn-group" ng-switch on="@(config.name).config.select.isSelectAll">
			<button class="btn" ng-click="@(config.name).selectAll(true)"  ng-show="@(config.name).showButton('select')"  ng-switch-when="false" data-toggle="tooltip" title="@Messages("datatable.button.selectall")"><i class="icon-check icon-large"></i>@if(!config.compact){ @Messages("datatable.button.selectall")}</button>
			<button class="btn" ng-click="@(config.name).selectAll(false)" ng-show="@(config.name).showButton('select')"  ng-switch-when="true" data-toggle="tooltip" title="@Messages("datatable.button.unselectall")"><i class="icon-check-empty icon-large"></i>@if(!config.compact){ @Messages("datatable.button.unselectall")}</button>			
			<button class="btn" ng-click="@(config.name).cancel()"  ng-show="@(config.name).showButton('cancel')" data-toggle="tooltip" title="@Messages("datatable.button.cancel")"><i class="icon-undo icon-large"></i>@if(!config.compact){ @Messages("datatable.button.cancel")}</button>		
	</div>
	@if(config.show){
	<button class="btn" ng-click="@(config.name).show()" ng-disabled="!@(config.name).isSelect()" ng-show="@(config.name).showButton('show')" data-toggle="tooltip" title="@Messages("datatable.button.show")">
		<i class="icon-pushpin icon-large"></i>@if(!config.compact){ @Messages("datatable.button.show")}
	</button>
	}
	
	@if(config.edit || config.remove || config.save){	
	<div class="btn-group">
		@if(config.edit){
		<button class="btn" ng-click="@(config.name).setEditColumn()" ng-disabled="!@(config.name).canEdit()"  ng-show="@(config.name).showButton('edit')" data-toggle="tooltip" title="@Messages("datatable.button.edit")">
		<i class="icon-edit icon-large"></i>@if(!config.compact){ @Messages("datatable.button.edit")}
		</button>
		}
		@if(config.save){
		<button class="btn" ng-click="@(config.name).save()" ng-disabled="!@(config.name).canSave()" ng-show="@(config.name).showButton('save')"  data-toggle="tooltip" title="@Messages("datatable.button.save")" >
		<i class="icon-save icon-large"></i>@if(!config.compact){ @Messages("datatable.button.save")}
		</button> 
		}
		@if(config.remove){
		<button class="btn" ng-click="@(config.name).remove()" ng-disabled="!@(config.name).canRemove()" ng-show="@(config.name).showButton('remove')"  data-toggle="tooltip" title="@Messages("datatable.button.remove")">
		<i class="icon-trash icon-large"></i>@if(!config.compact){ @Messages("datatable.button.remove")}
		</button>
		}			
	</div>
	}	
	@if(config.hidding){
	<div class="btn-group" ng-show="@(config.name).config.hide.active">>
		<button data-toggle="dropdown" class="btn dropdown-toggle" data-toggle="tooltip" title="@Messages("datatable.button.hide")">
		<i class="icon-eye-close icon-large"></i>@if(!config.compact){ @Messages("datatable.button.hide")}
			<span class="caret"></span>
		</button>
		<ul class="dropdown-menu">
				<li ng-repeat="column in @(config.name).getHideColumns()">
					<a href="#" ng-click="@(config.name).setHideColumn(column.id)">
					<i class="icon-eye-open" ng-show="@(config.name).isHide(column.id)""></i>
					<i class="icon-eye-close" ng-hide="@(config.name).isHide(column.id)"></i> {{column.header}}
					</a>
				</li>																
		</ul>		
	</div>
	}
	@buttons
</div>
}
</div>
<div class="span6">
<div class="span7">
<div class="pagination pagination-right" ng-show="@(config.name).isShowPagination()">
    <ul>
    	<li ng-repeat="page in @(config.name).config.pagination.pageList" ng-class="page.clazz"><a href="#" ng-click="@(config.name).setPageNumber(page)">{{page.label}}</a></li>    
    </ul>
</div>
</div>
<div class="span5">
<div class="btn-toolbar pull-right" ng-show="@(config.name).isShowToolbarRight()">
	<button class="btn btn-info" disabled="disabled" ng-show="@(config.name).config.showTotalNumberRecords">
		@Messages("datatable.totalNumberRecords", "{{"+config.name+".totalNumberRecords}}")
	</button>
	<div class="btn-group" ng-show="@(config.name).config.pagination.active">
		<button data-toggle="dropdown" class="btn dropdown-toggle">
			@Messages("datatable.button.length", "{{"+config.name+".config.pagination.numberRecordsPerPage}}") <span class="caret"></span>					
		</button>
		<ul class="dropdown-menu pull-right">
				<li	ng-repeat="elt in @(config.name).config.pagination.numberRecordsPerPageList" class={{elt.clazz}}>
					<a href="#" ng-click="@(config.name).setNumberRecordsPerPage(elt)">{{elt.number}}</a>
				</li>
			</ul>
	</div>			
</div>
</div>
</div>
</div>
<div class="row-fluid">
<form class="form-inline">
<table class="table table-condensed table-hover table-bordered">
	<thead>
	<tr>
		<th ng-repeat="column in @(config.name).getColumnsConfig()" @if(config.hidding){ng-hide="@(config.name).isHide(column.id)"}> {{column.header}}
		<div class="btn-group pull-right">
			@if(config.editColumn){<button class="btn btn-mini" ng-click="@(config.name).setEditColumn(column.id)" ng-show="column.edit" ng-disabled="!@(config.name).canEdit()" data-toggle="tooltip" title="@Messages("datatable.button.edit")"><i class="icon-edit"></i></button>}
			@if(config.order){<button class="btn btn-mini" ng-click="@(config.name).setOrderColumn(column.property, column.id)" ng-show="column.order" ng-disabled="!@(config.name).canOrder()" data-toggle="tooltip" title="@Messages("datatable.button.sort")"><i ng-class="@(config.name).getOrderColumnClass(column.id)"></i></button>}
			@if(config.hidding){<button class="btn btn-mini" ng-click="@(config.name).setHideColumn(column.id)" ng-show="column.hide" data-toggle="tooltip" title="@Messages("datatable.button.hide")"><i class="icon-eye-close"></i></button>}			
		</div>					
		</th>
	</tr>
	</thead>
	<tbody>
	<!-- first line to edit mode -->
	@if(config.editColumn){
	<tr ng-show="@(config.name).isEdit()">
		@for(column: DatatableColumn <- config.columns){
			<td @if(column.hide){ng-hide="@(config.name).isHide('@column.id')"}>
			@if(column.edit){<input type="text" class="input-medium" ng-change="@(config.name).updateColumn('@column.property', '@column.id')" ng-model="@(config.name).config.edit.columns.@(column.id).value" ng-show="@(config.name).isEdit('@column.id')"/>}</td>
		}
	</tr>
	}
	<tr ng-repeat="value in @(config.name).displayResult | orderBy:@(config.name).config.orderBy:@(config.name).config.orderReverse" ng-click="@(config.name).select(value)" ng-class="value.trClass">
		@for(column: DatatableColumn <- config.columns){
				<td @if(column.hide){ng-hide="@(config.name).isHide('@column.id')"} 
					@if(column.edit){ng-switch on="@(config.name).isEdit('@column.id', value)"}>				
				<span @if(column.edit){ng-switch-default}>@addColumnFormatter(config.name, column)</span>
				@if(column.edit){<input ng-switch-when="true" type="text" class="input-medium" ng-model="value.@column.property"/>}
				</td>
		}
	</tr>
	</tbody>
</table>
</form>
   
</div>
</div>