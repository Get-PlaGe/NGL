@()
@import views.html.helper._
@form() = {
	@columnSearchForm{			
			@formGroup{	
			<div bt-select placeholder="@Messages("experiments.select.experimentType.transformations")" class="form-control" ng-model="searchService.form.nextExperimentTypeCode" ng-class="errors.experimentType" bt-options="experimentType.code as experimentType.name for experimentType in searchService.lists.get('transformation')" ng-change="changeExperimentType('transformation')" auto-select>
			</div>
			}
			<hr>
			@formGroup{		
				<div bt-select placeholder="@Messages("processes.select.processCategory")" class="form-control" ng-model="searchService.form.processCategory"  bt-options="processCategory.code as processCategory.name for processCategory in searchService.lists.getProcessCategories()" ng-change="changeProcessCategory()" auto-select>
				</div>				
			}
			@formGroup{
				<div class="form-control" bt-select ng-model="searchService.form.projectCodes" multiple="true" filter="true" placeholder='@Messages("search.placeholder.projects")' bt-options="project.code as project.code for project in searchService.lists.getProjects()"></div>
			}
					
		}
		@columnSearchForm{
			@formGroup{
				<div bt-select placeholder="@Messages("experiments.select.experimentType.transferts")" class="form-control" ng-model="searchService.form.nextExperimentTypeCode" ng-class="errors.experimentType" bt-options="experimentType.code as experimentType.name for experimentType in searchService.lists.get('transfert')" ng-change="changeExperimentType('transfert')" >
				</div>
			}
			<hr>
			@formGroup{		
				<div bt-select placeholder="@Messages("processes.select.processType")" class="form-control" ng-model="searchService.form.processTypeCode" bt-options="processType.code as processType.name for processType in searchService.lists.getProcessTypes()" ng-change="changeProcessType()" auto-select>
				</div>				
			}
			@formGroup{		
				<div class="form-control" bt-select ng-model="searchService.form.sampleCodes" multiple="true" filter="true" placeholder='@Messages("search.placeholder.samples")' bt-options="sample.code as sample.code for sample in searchService.lists.getSamples()" ng-focus="refreshSamples()"></div>			
			}
		}
		@columnSearchForm{
			@formGroup{	
				<div bt-select placeholder="@Messages("experiments.select.experimentType.qualitycontrols")" class="form-control" ng-model="searchService.form.nextExperimentTypeCode" ng-class="errors.experimentType" bt-options="experimentType.code as experimentType.name for experimentType in searchService.lists.get('qualitycontrol')" ng-change="changeExperimentType('qualitycontrol')" auto-select>
				</div>
			}
			<hr>
			@formGroup{		
				<input class="form-control" type="text" ng-model="searchService.form.fromDate" placeholder='@Messages("containerSupports.placeholder.fromDate")' title='@Messages("containerSupports.placeholder.fromDate")'>				
			}
			@formGroup{		
				<input class="form-control" type="text" ng-model="searchService.form.code" placeholder='@Messages("search.placeholder.containerSupport")' title='@Messages("search.placeholder.containerSupport")'>
			}
		}
		@columnSearchForm{
			@formGroup{	
				<div bt-select placeholder="@Messages("experiments.select.experimentType.purifications")" class="form-control" ng-model="searchService.form.nextExperimentTypeCode" ng-class="errors.experimentType" bt-options="experimentType.code as experimentType.name for experimentType in searchService.lists.get('purification')" ng-change="changeExperimentType('purification')" auto-select>
				</div>
			}
			<hr>
			@formGroup{
				<input class="form-control" type="text" ng-model="searchService.form.toDate" placeholder='@Messages("containerSupports.placeholder.toDate")' title='@Messages("containerSupports.placeholder.toDate")'>
			}
			@formGroup{
				<div class="form-control" bt-select ng-model="searchService.form.fromExperimentTypeCodes" multiple="true" placeholder="@Messages("containerSupports.table.fromExperimentTypeCodes")" 
				bt-options="expType.code as expType.name for expType in searchService.lists.getExperimentTypes()">
				</div>	
		}
						
		}
		@columnSearchForm{
			@formGroup{
				<div bt-select placeholder="@Messages("containers.select.categorySupportCode")" class="form-control" ng-class="errors.containerSupportCategory" ng-model="searchService.form.containerSupportCategory" bt-options="CategorySupport.code as CategorySupport.name for CategorySupport in searchService.lists.getContainerSupportCategories()" auto-select>
				</div>
			}
			<hr>
			@formGroup{	
				<input class="form-control" type="text" ng-model="searchService.form.users" typeahead="user.name as user.name for user in searchService.lists.getUsers() | filter:$viewValue | limitTo:20" placeholder='@Messages("containerSupports.placeholder.user")' title='@Messages("containerSupports.placeholder.user")'>			
									
			}
			@formGroup{
				
			
		}
		}
}


<!-- @searchForm(form)()("searchService.datatable") -->

<div class="row"> 
<div class="col-md-12 col-lg-12" datatable="datatable">
	<div dt-form>
		<ul class="nav nav-tabs margin-bottom-5">
	   	<li class="active"><a href="#" data-target="#filters" data-toggle="tab">@Messages("search.tab.filters")</a></li>
	   	<li ng-if="searchService.getAddFiltersToForm().length > 0"><a href="#" data-target="#addfilters" data-toggle="tab">@Messages("search.tab.addfilters")</a></li>
	   	<li ng-if="searchService.getAddColumnsToForm().length > 0"><a href="#" data-target="#addcolumns" data-toggle="tab">@Messages("search.tab.addcolumns")</a></li>       
	   	</ul>
			
		<div class="tab-content">
		<div class="tab-pane active" id="filters">
			<form class="well well-small">
			<div class="row">
			@form
			@columnSearchForm{
				@formGroup{
				<div class="btn-toolbar">
					<button type="submit" title='@Messages("button.search")' data-toggle="tooltip" ng-click="search()" class="btn btn-primary" >
						<i class="fa fa-search"></i>
					</button>
					<button title='@Messages("button.reset")' data-toggle="tooltip" ng-click="reset()"  class="btn btn-default">
						<i class="fa fa-undo"></i>
					</button>
												 	
				</div>	
				}
			}
			</div>		
		</form>	
	</div>
	
	<div class="tab-pane" id="addfilters">
	<form class="well well-small">
			<div ng-if="searchService.isProcessFiltered" class="row">				
					<div class="col-md-2 col-lg-2" ng-repeat="processFilters in searchService.getAddProcessFiltersToForm()">
						<div class="form-group" ng-repeat="filter in processFilters">
							<div dt-compile="filter.html"></div> <!-- used directive from datatable to compile html -->
						</div>
					</div>									
				</div>
				
			<hr ng-if="searchService.isProcessFiltered" class="filterLine">
				
			<div class="row">
				<div class="col-md-2 col-lg-2" ng-repeat="filters in searchService.getAddFiltersToForm()">
					<div class="form-group" ng-repeat="filter in filters">
						<div dt-compile="filter.html"></div> <!-- used directive from datatable to compile html -->
					</div>
				</div>
				
				@columnSearchForm{
				@formGroup{
				<div class="btn-toolbar">
					<button type="submit" title='@Messages("button.search")' data-toggle="tooltip" ng-click="search()" class="btn btn-primary" >
						<i class="fa fa-search"></i>
					</button>
					<button title='@Messages("button.reset")' data-toggle="tooltip" ng-click="reset()"  class="btn btn-default">
						<i class="fa fa-undo"></i>
					</button>
												 	
				</div>	
				}
				
			}
			</div>			
		</form>	
	</div>
	
	<div class="tab-pane" id="addcolumns">
	<form class="well well-small">
			<div class="row">
			<div class="col-md-2 col-lg-2" ng-repeat="columns in searchService.getAddColumnsToForm()">
			  		<div class="checkbox" ng-repeat="column in columns">
				    <label>
				      <input type="checkbox" ng-model="column.select"> {{column.header}}
				    </label>
				  </div>			
			 </div>
			 @columnSearchForm{
				@formGroup{
				<div class="btn-toolbar">
					<button type="submit" title='@Messages("button.search")' data-toggle="tooltip" ng-click="searchService.addColumnsToDatatable()" class="btn btn-primary" >
						<i class="fa fa-plus"></i>
					</button>
					<button title='@Messages("button.reset")' data-toggle="tooltip" ng-click="searchService.resetDatatableColumns()"  class="btn btn-default">
						<i class="fa fa-undo"></i>
					</button>												 	
				</div>	
				}					
			}
			</div>			
		</form>	
	</div>
	
	</div>
	</div>
</div>
</div>
