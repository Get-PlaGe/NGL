@(laneCount:java.lang.Integer)
<ul class="nav nav-tabs" role="tablist">
  <li class="active"><a href="" role="tab" data-target="#flowcell" data-toggle="tab">@Messages("experiments.flowcell.design")</a></li>
  <li><a href="" role="tab"  data-target="#roadmap" data-toggle="tab">@Messages("experiments.flowcell.roadMap")</a></li>
</ul>
{{tab}}
<div class="row tab-content tabPaneTable" ng-controller="FlowcellCtrl" ng-init="init_flowcell(@laneCount)">
	<div class="col-md-12 col-lg-12 tab-pane active" style="margin-right:auto;margin-left:auto" id="flowcell">
	<!-- TODO: Supprimer droppable quand l'expérience  est terminée -->
		<div ng-model="inputContainers" ng-if="doneAndRecorded==true" class="col-md-4 col-lg-4 inputContainerGroup">
		<p  ng-show="inputContainers.length==0"><i class="fa fa-download"></i> Inputs</p>
		</div>
		<div ng-model="inputContainers" ng-if="doneAndRecorded==false" droppable class="col-md-4 col-lg-4 inputContainerGroup">		
			<p  ng-show="inputContainers.length==0"><i class="fa fa-download"></i> Inputs</p>
			<table ng-show="inputContainers.length>0" class="table" >
			<thead>
				<tr>
					<th>
					</th>
					<th>
						@Messages("containers.table.code")
					</th>
					<th>
						@Messages("containers.table.percentage")
					</th>
					<th>
						@Messages("containers.table.tags")
					</th>
					<th>
						@Messages("containers.table.sampleTypes")
					</th>
					<th>
						@Messages("containers.table.libProcessTypeCodes")
					</th>
					<th>
					</th>
				</tr>
				</thead>				
				<tr ng-model="container" ng-repeat="container in inputContainers | orderBy:'code'" draggable>
					<td>
						<button ng-disabled="!experiment.experimentProperties.enabled" ng-click="deleteInput(container)" class="litte-icone"><i class="fa fa-trash-o"></i></button>
					</td>
					<td>
						{{container.code}}
					</td>
					<td class="col-sm-1">
						<input class="form-control input-small valueInput" type="text" placeholder="" ng-readonly="!experiment.experimentProperties.enabled" ng-model="container.percentage" title='@Messages("containers.table.percentage")'/>
					</td>					
					<td>
						<div list-resize="properties.tag.value in getTags(container.contents) | unique" list-resize-min-size='5' below vertical></div>						
					</td>
					<td title="{{getSampleTypeCodes(container.contents) | unique}}">
						<div ng-repeat="content in container.contents | unique:'sampleTypeCode'  | limitTo: 12">
							{{content.sampleTypeCode}}
						</div>
						
					</td>
					<td title="{{getLibProcessTypeCodes(container.contents) | unique}}">
						<div ng-repeat="content in container.contents | unique:'properties.libProcessTypeCode.value'">
							{{content.properties.libProcessTypeCode.value}}
						</div>
					</td>
					<td>
					<button ng-click="duplicateContainer(container,$index)"><i class="fa fa-plus-square"></i></button>
					</td>
				</tr>				
			</table>
		</div>
		<div class="col-md-5 col-lg-5 compoFlowcel">
		<h2>@Messages("experiments.flowcell.design") :</h2> 
			
		<table class="table" >
		<tr>
		<th>
		<button ng-click="hideRowAll()"  ng-if="isFilled() && isAllOpen" class="litte-eye headButtonEye"><i class="fa fa-eye-slash"></i></button>
		<button ng-click="showRowAll()"  ng-if="isFilled() && !isAllOpen" class="litte-eye headButtonEye"><i class="fa fa-eye"></i></button>	
		</th>
		<th> </th>	
		<th> </th>					
		<th ng-if="isFilled() && isAllOpen">
		<div class="insertHeadFC" ng-repeat="property in experiment.containerOutProperties track by $index">
		<input class="form-control valueInput" ng-if="isFilled()" type="text"  ng-readonly="!experiment.experimentProperties.enabled" 
				 ng-change="updateColumnPropertyCodeValues(property.code)" ng-blur="changeValueInFlowcellCompo()" ng-model="allOutputContainersUsed[property.code].value" />		
		</div>
		</th>
		</tr>
		@for(i <- 0 to laneCount-1) {			
		<tr class="flowCellLane">			
			<th id="numberLane">
				<b class="numberLane">@(i+1)</b>
			</th>
			
				<th ng-if="experiment.value.atomicTransfertMethods[@i].inputContainerUseds.length > 0">
					<button ng-click="hideRow(@i)"  ng-show="experiment.value.atomicTransfertMethods[@i].inputContainerUseds.length > 0" class="litte-eye"><i ng-show="rows[@i]" class="fa fa-eye-slash"></i><i  ng-show="!rows[@i]" class="fa fa-eye"></i></button>
				</th>
			
			
			<td ng-model="experiment.value.atomicTransfertMethods[@i].inputContainerUseds" droppable ng-if="!experiment.value.atomicTransfertMethods[@i].inputContainerUseds.length > 0" colspan="7">	 
			<td ng-model="experiment.value.atomicTransfertMethods[@i].inputContainerUseds" ng-if="experiment.value.atomicTransfertMethods[@i].inputContainerUseds.length > 0">
				<div ng-hide="rows[@i]" class="LaneSummary">
					<span  ng-repeat="flowcell in experiment.value.atomicTransfertMethods[@i].inputContainerUseds">
						{{flowcell.code}} / {{flowcell.percentage}}% / PhiX:{{experiment.value.atomicTransfertMethods[@i].outputContainerUsed.experimentProperties.phixPercent.value || "nr"}}%;<br/>
					</span>
				</div>
				<div class="LaneOutput" ng-show="rows[@i]">
				<table ng-show="experiment.value.atomicTransfertMethods[@i].inputContainerUseds.length > 0 && rows[@i]" class="table">
				<tr>
					<th class="LaneData">
						@Messages("containers.table.code")
					</th>
					<th>
						@Messages("containers.table.percentage")
					</th>
					<th class="tagCell">
						@Messages("containers.table.sampleCodeAndTags")
					</th>
			@**	 	<th>
						@Messages("containers.table.tags")
					</th>  **@
					<th>
						@Messages("containers.table.sampleTypes")
					</th>
					<th>
						@Messages("containers.table.libProcessTypeCodes")
					</th>
				</tr>				
					<tr ng-repeat="flowcell in experiment.value.atomicTransfertMethods[@i].inputContainerUseds"  ng-model="flowcell"  draggable>				
						<td class="LaneData">							
							{{flowcell.code}}
						</td>
						<td>
							<input class="form-control valueInput" type="text" title='@Messages("containers.table.percentage")' ng-readonly="!experiment.experimentProperties.enabled" class="input-small" ng-model="flowcell.percentage" />
						</td>
						<td>							
							<div list-resize="sampleAndTag in getSampleAndTags(flowcell) | unique" id="SampleTagCell" below vertical></div>
						</td>
				@**		<td  title="{{getTags(flowcell.contents) | unique}}" ng-init="nbItem2 = 5">
						<div ng-repeat="content in flowcell.contents | unique:'properties.tag.value' |  limitTo:nbItem2">
								{{content.properties.tag.value}}
							</div>							
							
						<button ng-show="nbItem2==5 && flowcell.contents.length>5" ng-click="nbItem2=flowcell.contents.length" class="small-litte-icone-transparent"> <i><b>...</b></i> </button>
						<button ng-show="nbItem2>5 && flowcell.contents.length>5" ng-click="nbItem2=5" class="small-litte-icone-transparent "> <i class="fa fa-minus-square-o"></i> </button>
						</td> **@
						<td title="{{getSampleTypeCodes(flowcell.contents) | unique}}">
							<div ng-repeat="content in flowcell.contents | unique:'sampleTypeCode' |  limitTo:12">
								{{content.sampleTypeCode}}
							</div>
						</td> 
						<td title="{{getLibProcessTypeCodes(flowcell.contents) | unique}}">
							<div ng-repeat="content in flowcell.contents | unique:'properties.libProcessTypeCode.value'">
								{{content.properties.libProcessTypeCode.value}}
							</div>
						</td>
						<!--<td>
								<button ng-disabled="!experiment.experimentProperties.enabled" ng-click="deleteInputOnAtomic(@i,container)"><i class="fa fa-trash-o"></i></button>
					    </td>  -->
					</tr>		
					
					<tr ng-model="experiment.value.atomicTransfertMethods[@i].inputContainerUseds" droppable><td colspan=6 id="dropZone"> </td></tr>
				</table>
			</div>
			</td>			
			<td ng-if="experiment.value.atomicTransfertMethods[@i].inputContainerUseds.length > 0 && rows[@i]">
			
			<table ng-show="experiment.value.atomicTransfertMethods[@i].inputContainerUseds.length > 0 && rows[@i]" class="table">
				<tr>
					<th ng-repeat="property in experiment.containerOutProperties">
						{{property.name}}<span ng-if="property.displayMeasureValue"> ({{property.displayMeasureValue.value}})</span>
					</th>
				</tr>
			    <tr>
					<td style="min-width:70px" ng-repeat="property in experiment.containerOutProperties">
								<div ng-switch on="property.choiceInList">
								<input class="form-control valueInput" type="text" ng-switch-when="false" title="{{property.name}}"
									ng-readonly="!experiment.experimentProperties.enabled"
									ng-model="experiment.value.atomicTransfertMethods[@i].outputContainerUsed.experimentProperties[property.code].value"
								    ng-blur="changeValueInFlowcellCompo()"
								    ng-change="notifyChange(@i,property)"
								    />
									
								<select class="form-control"  
										ng-readonly="!experiment.experimentInformation.enabled" 
										ng-disabled="!experiment.experimentInformation.enabled" 
										ng-model="experiment.value.atomicTransfertMethods[@i].outputContainerUsed.experimentProperties[property.code].value"
										ng-switch-when="true" 
										ng-blur="changeValueInFlowcellCompo()"
										ng-change="notifyChange(@i,property)"
										auto-select>
									<option ng-repeat="opt in property.possibleValues" value="{{opt.value}}">{{opt.value}}</option>
								   </select>
								   </div>
					</td>
			</tr>
			</table>
			
			</td>			
		</tr>
		}
		</table>
		</div>
	</div>
	<div class="tab-pane roadmap" id="roadmap">
		<div class="col-md-12 col-lg-12" datatable="datatable"></div>
	</div>
</div>