@()
<!-- work with atmDragAndDrop2 -->
<table class="table" >
<thead>
		<tr ng-if="!atmService.data.isAllATMViewClose">
			<th colspan="10">
				@Messages("experiments.inputs")
			</th>
			
			<th colspan="2">
				@Messages("experiments.outputs")
			</th>												
		</tr>
		<tr ng-if="!atmService.data.isAllATMViewClose">
			<th>
			</th>
			<th>
				<button ng-click="atmService.data.hideAllATM()"  ng-if="!atmService.data.isAllATMViewClose" class="btn btn-default btn-xs"><i class="fa fa-eye-slash"></i></button>
				<button ng-click="atmService.data.showAllATM()"  ng-if="atmService.data.isAllATMViewClose" class="btn btn-default btn-xs"><i class="fa fa-eye"></i></button>							
			</th>
			<th>
				@Messages("containers.table.code")
			</th>
			<th>
				@Messages("containers.table.fromTransformationTypeCodes")
			</th>						
			<th>
				@Messages("containers.table.project_sample")
			</th>						
			<th>
				@Messages("containers.table.tags")
			</th>
			<th>
				@Messages("containers.table.state.code")
			</th>
			<th>
				@Messages("containers.table.volume") (ÂµL)
			</th>
			<th>
				@Messages("containers.table.concentration")
			</th>									
			<th>
				@Messages("containers.table.percentageInsidePool")
			</th>
			<th>
				@Messages("containers.table.code")
			</th>
			<th>
				@Messages("containers.table.volume") (ÂµL)
			</th>		
		</tr>
		<tr ng-if="atmService.data.isAllATMViewClose" colspan="10">
			<th>
			</th>
			<th>
				<button ng-click="atmService.data.hideAllATM()"  ng-if="!atmService.data.isAllATMViewClose" class="btn btn-default btn-xs"><i class="fa fa-eye-slash"></i></button>
				<button ng-click="atmService.data.showAllATM()"  ng-if="atmService.data.isAllATMViewClose" class="btn btn-default btn-xs"><i class="fa fa-eye"></i></button>							
			</th>
		</tr>
	<thead>


<tbody ng-repeat="atm in atmService.data.atm | orderBy:'line' track by $index" ng-model="atm.inputContainerUseds" 				
	ng-switch="atmService.data.getATMViewMode(atm, $index)">
	
	<tr ng-switch-when="empty">
		<td>			
			<span class="label label-black" ng-bind="$index + 1"></span>
		</td>
		<td> 
			<button class="btn btn-default btn-xs"  ng-click="atmService.data.toggleATM($index)" ng-switch="atmService.data.atmViewOpen[$index]">
				<i ng-switch-when="true" class="fa fa-eye-slash"></i>
				<i ng-switch-when="false" class="fa fa-eye"></i>
			</button>			
		</td>
		<td colspan="10"></td>
	</tr>
	
	<tr ng-switch-when="compact" >	
		<td  class="compactColumn">
			<span class="label label-black" ng-bind="$index + 1"></span>
		</td >
		<td class="compactColumn"> 					
			<button class="btn btn-default btn-xs"  ng-click="atmService.data.toggleATM($index)">
				<!--  i class="fa fa-eye-slash"></i-->
				<i class="fa fa-eye"></i>
			</button>			
		</td>	
		<td colspan="10" >
			<span ng-repeat="inputContainerUsed in atm.inputContainerUseds | orderBy:'code' track by $index"  class="compactText"
				ng-model="inputContainerUsed" draggable drag="dragInProgress">
				{{inputContainerUsed.code}} / {{inputContainerUsed.percentage}}%;<br/>
			</span>
		</td>
	</tr>
	
	<tr ng-switch-when="open" ng-repeat="inputContainerUsed in atm.inputContainerUseds | orderBy:'code' track by $index"  
				ng-model="inputContainerUsed">	
			<td rowspan="{{atm.inputContainerUseds.length}}" ng-if="$index === 0">
				<span class="form-control-static label label-black" ng-bind="$parent.$parent.$index + 1"></span>
			</td>
			<td rowspan="{{atm.inputContainerUseds.length}}" ng-if="$index === 0">
				<!-- ng-if add a new child scope so we need to use $parent.$parent.$index -->
				<button class="btn btn-default btn-xs btn-block"  ng-click="atmService.data.toggleATM($parent.$parent.$index)">
					<i class="fa fa-eye-slash"></i>
					<!-- i class="fa fa-eye"></i-->
				</button>
				<button class="btn btn-default btn-xs btn-block"  ng-click="atmService.data.deleteATM($parent.$parent.$index)" ng-show="isNewState()">
					<i class="fa fa-trash-o"></i>
					<!-- i class="fa fa-eye"></i-->
				</button>			
			</td>	
			
				<td>
					{{inputContainerUsed.code}}
				</td>
				<td>
					<div list-resize='inputContainerUsed.fromTransformationTypeCodes | unique | codes:"type"' list-resize-min-size='5' below vertical>
				</td>
				<td>
					<div list-resize="inputContainerUsed.contents | collect:'projectCode+&quot; / &quot;+sampleCode'" list-resize-min-size="5" vertical>																					
				</td>						
				<td>
					<div list-resize='inputContainerUsed.contents | getArray:"properties.tag.value"| unique' list-resize-min-size='5' below vertical>															
				</td>
				<td>
					{{inputContainerUsed.state.code | codes:'state'}}
				</td>
				<td>
					{{inputContainerUsed.volume.value}}
				</td>
				<td>
					{{inputContainerUsed.concentration.value | number}} {{inputContainerUsed.concentration.unit}}
				</td> 														
				<td>
					<div ng-switch on="mainService.isEditMode()">						
						<p class="form-control-static" ng-switch-when="false" ng-bind="inputContainerUsed.percentage" />						 
						<div ng-switch-when="true">
							<input class="form-control input-sm" 
								type="text"
								ng-model="inputContainerUsed.percentage" 
								title='@Messages("containers.table.percentage")' 
								ng-change="atmService.data.updateDatatable()"/>									
						</div>
					</div>
				</td>
			
				<td rowspan="{{atmService.data.atm[0].inputContainerUseds.length}}"
					ng-if="$index === 0">
					<p class="form-control-static"  ng-bind="atmService.data.atm[0].outputContainerUseds[0].code" />
				</td>
				<td rowspan="{{atmService.data.atm[0].inputContainerUseds.length}}"	ng-if="$index === 0">
					<div ng-switch on="mainService.isEditMode()">						
						<p class="form-control-static" ng-switch-when="false" ng-bind="atmService.data.atm[0].outputContainerUseds[0].volume.value" />						 
						<div ng-switch-when="true">
							<input class="form-control input-sm" type="text" title="Messages("containers.table.volume")"									
							ng-model="atmService.data.atm[0].outputContainerUseds[0].volume.value"
				   			ng-change="atmService.data.updateDatatable()"								   			
			   				/>										
						</div>
					</div>						
				</td>												
		</tr>					
</tbody>	
</table>